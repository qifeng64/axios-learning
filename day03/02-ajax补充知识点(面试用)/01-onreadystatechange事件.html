<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /* 
        学习目标 ： 了解 XMLHttpRequest对象的两个事件

        1.  onload事件 : 一次请求, 只会执行一次
        2.  onreadystatechange : 一次请求,会执行多次
          * 执行时机: (面试点)xhr请求状态变化
            0. 请求未初始化
            1. 服务器已连接
            2. 请求已接收
            3. 服务器处理中
            4. 服务器已响应
        */

      // 1 创建xhr对象
      let xhr = new XMLHttpRequest();
      console.log(xhr.readyState); // 0 请求未初始化（没有设置请求方法和地址）

      // 2 设置请求方法和地址
      xhr.open("get", "http://www.liulongbin.top:3006/api/getbooks");
      console.log(xhr.readyState); // 1 服务器已连接

      // 3 发送请求
      xhr.send();
      console.log(xhr.readyState); // 1 服务器已连接

      // 4 注册响应事件
      xhr.onreadystatechange = function () {
        console.log(xhr.readyState); // 2、3、4  执行三次   请求、处理、响应

        // onload 事件只会走一次，就是 readyStatus 为4的时候执行
        if (xhr.readyState == 4) {
          console.log(xhr.responseText);
        }
      };
    </script>
  </body>
</html>
